--- origsrc/webkit-1.3.12/GNUmakefile.am	2011-01-17 03:26:32.000000000 -0600
+++ src/webkit-1.3.12/GNUmakefile.am	2011-03-06 17:06:17.873278700 -0600
@@ -114,9 +114,9 @@ global_cxxflags += \
 
 # -no-undefined required for building DLLs on Windows
 # It breaks the build on other platforms, so we use it conditionally
-if OS_WIN32
+if PLATFORM_WIN32
 no_undefined = -no-undefined
-version_script = -export-symbols-regex "^(webkit_|k?JS).*"
+version_script = -export-symbols-regex "^(webkit_|k?JS|_ZN24DumpRenderTreeSupportGtk).*"
 endif
 
 if OS_GNU
--- origsrc/webkit-1.3.12/Tools/GNUmakefile.am	2011-02-22 05:11:18.000000000 -0600
+++ src/webkit-1.3.12/Tools/GNUmakefile.am	2011-04-17 12:28:31.704146500 -0500
@@ -102,6 +102,7 @@
 	$(LIBSOUP_CFLAGS)
 
 Programs_DumpRenderTree_LDADD = \
+	libJavaScriptCore.la \
 	libwebkitgtk-@WEBKITGTK_API_MAJOR_VERSION@.@WEBKITGTK_API_MINOR_VERSION@.la \
 	$(GLOBALDEPS_LIBS) \
 	$(CAIRO_LIBS) \
@@ -198,5 +199,7 @@
 	-avoid-version \
 	-module
 
+TestNetscapePlugin_libtestnetscapeplugin_la_LIBADD = -lX11
+
 CLEANFILES += TestNetscapePlugin/libtestnetscapeplugin.la
 endif
